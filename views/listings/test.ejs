
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ayuvaani Connect | Healthcare Services</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/starability/starability-minified/starability-all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <style>
        :root {
            --healthcare-blue: #1a75ff;
            --healthcare-dark-blue: #0056b3;
            --healthcare-light-blue: #e6f0ff;
            --healthcare-green: #28a745;
            --light-gray: #f7f7f7;
            --medium-gray: #717171;
            --dark-gray: #222222;
            --border-radius: 12px;
            --shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
        }
        
        body {
            background-color: #fff;
            color: var(--dark-gray);
            padding-top: 80px;
        }
        
        /* Navbar */
        .navbar {
            background-color: #fff;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08);
            padding: 14px 0;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
        }
        
        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--healthcare-blue);
            letter-spacing: -1px;
        }
        
        .navbar-nav .nav-link {
            color: var(--dark-gray);
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.2s ease;
        }
        
        .navbar-nav .nav-link:hover {
            background-color: var(--healthcare-light-blue);
            color: var(--healthcare-blue);
        }
        
        /* Listing Header */
        .listing-header {
            padding: 24px 0 16px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .listing-title {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--healthcare-dark-blue);
        }
        
        .listing-subtitle {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 16px;
            color: var(--medium-gray);
        }
        
        .guest-favorite {
            background-color: var(--healthcare-light-blue);
            border-radius: 4px;
            padding: 8px 12px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-top: 12px;
            color: var(--healthcare-dark-blue);
        }
        
        .guest-favorite i {
            color: var(--healthcare-blue);
        }
        
        /* Image Gallery */
        .image-gallery {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 8px;
            height: 500px;
            margin-bottom: 32px;
            max-width: 1200px;
            margin: 0 auto 32px;
        }
        
        .gallery-main {
            grid-column: 1 / span 2;
            grid-row: 1 / span 2;
            border-radius: var(--border-radius);
            overflow: hidden;
        }
        
        .gallery-main img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .gallery-item {
            border-radius: var(--border-radius);
            overflow: hidden;
        }
        
        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        /* Main Content */
        .main-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 48px;
            padding-bottom: 64px;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Listing Details */
        .listing-info {
            border-bottom: 1px solid #ebebeb;
            padding-bottom: 32px;
            margin-bottom: 32px;
        }
        
        .listing-highlights {
            display: flex;
            align-items: center;
            gap: 24px;
            margin-bottom: 32px;
            flex-wrap: wrap;
        }
        
        .highlight-item {
            display: flex;
            flex-direction: column;
            min-width: 200px;
        }
        
        .highlight-icon {
            font-size: 1.5rem;
            margin-bottom: 8px;
            color: var(--healthcare-blue);
        }
        
        .host-info {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
        }
        
        .host-avatar {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background-color: var(--healthcare-light-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--healthcare-blue);
        }
        
        .description {
            line-height: 1.6;
            margin-bottom: 32px;
            color: #333;
        }
        
        /* Amenities */
        .amenities-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 32px;
        }
        
        .amenity-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        
        .amenity-item i {
            color: var(--healthcare-blue);
        }
        
        /* Booking Card */
        .booking-card {
            border: 1px solid #ebebeb;
            border-radius: var(--border-radius);
            padding: 24px;
            box-shadow: var(--shadow);
            position: sticky;
            top: 100px;
            background-color: #fff;
        }
        
        .price-per-night {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--healthcare-dark-blue);
        }
        
        .date-picker {
            border: 1px solid #ebebeb;
            border-radius: 8px;
            overflow: hidden;
            margin: 16px 0;
        }
        
        .date-row {
            display: flex;
            border-bottom: 1px solid #ebebeb;
        }
        
        .date-col {
            flex: 1;
            padding: 12px;
        }
        
        .date-col:first-child {
            border-right: 1px solid #ebebeb;
        }
        
        .date-label {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 4px;
            color: var(--medium-gray);
        }
        
        .guests-select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ebebeb;
            border-radius: 8px;
            margin: 16px 0;
        }
        
        .book-btn {
            background: linear-gradient(to right, var(--healthcare-blue) 0%, var(--healthcare-dark-blue) 100%);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 14px;
            width: 100%;
            font-weight: 600;
            font-size: 1rem;
            margin: 8px 0 16px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .book-btn:hover {
            background: linear-gradient(to right, var(--healthcare-dark-blue) 0%, #004494 100%);
        }
        
        .price-breakdown {
            border-top: 1px solid #ebebeb;
            padding-top: 16px;
            margin-bottom: 16px;
        }
        
        .price-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            color: var(--dark-gray);
        }
        
        .price-total {
            display: flex;
            justify-content: space-between;
            font-weight: 600;
            border-top: 1px solid #ebebeb;
            padding-top: 16px;
            margin-top: 8px;
            color: var(--dark-gray);
        }
        
        /* Ratings Section */
        .ratings-section {
            border-bottom: 1px solid #ebebeb;
            padding-bottom: 32px;
            margin-bottom: 32px;
        }
        
        .overall-rating {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
        }
        
        .rating-value {
            font-size: 2rem;
            font-weight: 600;
            color: var(--healthcare-dark-blue);
        }
        
        .rating-stars {
            color: var(--healthcare-blue);
            font-size: 1.2rem;
            margin-bottom: 4px;
        }
        
        .rating-category {
            display: flex;
            justify-content: space-between;
            margin-bottom: 16px;
        }
        
        .rating-category-name {
            font-weight: 500;
        }
        
        /* Reviews Section */
        .review-card {
            border-bottom: 1px solid #ebebeb;
            padding: 24px 0;
        }
        
        .review-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .review-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background-color: var(--healthcare-light-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: var(--healthcare-blue);
        }
        
        .reviewer-info {
            flex: 1;
        }
        
        .reviewer-name {
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .review-date {
            color: var(--medium-gray);
            font-size: 0.9rem;
        }
        
        .review-content {
            line-height: 1.6;
            margin-bottom: 16px;
            color: #333;
        }
        
        .show-more {
            color: var(--dark-gray);
            font-weight: 600;
            text-decoration: underline;
            cursor: pointer;
        }
        
        .review-meta {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-top: 12px;
            color: var(--medium-gray);
            font-size: 0.9rem;
        }
        
        .review-meta-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        /* Review Form */
        .review-form {
            border: 1px solid #ebebeb;
            border-radius: var(--border-radius);
            padding: 24px;
            margin-top: 32px;
            background-color: #fff;
        }
        
        .form-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--healthcare-dark-blue);
        }
        
        .rating-slider {
            width: 100%;
            margin: 16px 0;
        }
        
        .rating-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: var(--medium-gray);
            margin-top: -12px;
        }
        
        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid #ebebeb;
            border-radius: 8px;
            margin: 8px 0 16px;
            font-family: inherit;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--healthcare-blue);
            box-shadow: 0 0 0 2px rgba(26, 117, 255, 0.2);
        }
        
        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }
        
        .submit-btn {
            background: linear-gradient(to right, var(--healthcare-blue) 0%, var(--healthcare-dark-blue) 100%);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 24px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .submit-btn:hover {
            background: linear-gradient(to right, var(--healthcare-dark-blue) 0%, #004494 100%);
        }
        
        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 16px;
            margin-top: 24px;
            flex-wrap: wrap;
        }
        
        .btn-edit {
            background: linear-gradient(to right, var(--healthcare-blue) 0%, var(--healthcare-dark-blue) 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            text-decoration: none;
            display: inline-block;
            transition: all 0.2s;
            text-align: center;
            cursor: pointer;
        }
        
        .btn-edit:hover {
            background: linear-gradient(to right, var(--healthcare-dark-blue) 0%, #004494 100%);
            color: white;
            text-decoration: none;
        }
        
        .btn-delete {
            background-color: white;
            color: var(--healthcare-blue);
            border: 2px solid var(--healthcare-blue);
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-delete:hover {
            background-color: var(--healthcare-light-blue);
        }
        
        /* Footer */
        .footer {
            background-color: #f7f7f7;
            padding: 40px 0;
            border-top: 1px solid #ebebeb;
        }
        
        .footer-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 24px;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
        }
        
        .footer-column h4 {
            font-size: 1rem;
            margin-bottom: 16px;
            font-weight: 600;
            color: var(--healthcare-dark-blue);
        }
        
        .footer-links {
            list-style: none;
            padding: 0;
        }
        
        .footer-links li {
            margin-bottom: 12px;
        }
        
        .footer-links a {
            color: var(--dark-gray);
            text-decoration: none;
            font-size: 0.9rem;
        }
        
        .footer-links a:hover {
            color: var(--healthcare-blue);
            text-decoration: underline;
        }
        
        .footer-bottom {
            max-width: 1200px;
            margin: 40px auto 0;
            padding: 0 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid #ebebeb;
            padding-top: 24px;
            flex-wrap: wrap;
        }
        
        .footer-lang-currency {
            display: flex;
            align-items: center;
            gap: 16px;
            font-size: 0.9rem;
        }
        
        .copyright {
            color: var(--medium-gray);
            font-size: 0.9rem;
        }
        
        .social-links {
            display: flex;
            gap: 16px;
            margin-top: 16px;
        }
        
        .social-links a {
            color: var(--dark-gray);
            font-size: 1.2rem;
        }
        
        .social-links a:hover {
            color: var(--healthcare-blue);
        }
        
        /* Healthcare specific styles */
        .healthcare-badge {
            background-color: var(--healthcare-green);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
            margin-right: 8px;
        }
        
        .specialty-tag {
            background-color: var(--healthcare-light-blue);
            color: var(--healthcare-dark-blue);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: inline-block;
            margin: 0 8px 8px 0;
        }
        
        .emergency-contact {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 16px;
            margin: 24px 0;
            border-radius: 4px;
        }
        
        /* Responsive adjustments */
        @media (max-width: 992px) {
            .image-gallery {
                height: 400px;
            }
            
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .booking-card {
                position: relative;
                top: 0;
            }
            
            .footer-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .image-gallery {
                height: 300px;
                grid-template-rows: 200px 100px;
            }
            
            .amenities-grid {
                grid-template-columns: 1fr;
            }
            
            .listing-highlights {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }
            
            .footer-bottom {
                flex-direction: column;
                gap: 16px;
                align-items: flex-start;
            }
        }
        
        @media (max-width: 576px) {
            .image-gallery {
                height: auto;
                grid-template-columns: 1fr;
                grid-template-rows: auto;
            }
            
            .gallery-main {
                grid-column: 1;
                grid-row: 1;
                height: 300px;
            }
            
            .gallery-item {
                height: 100px;
            }
            
            .footer-container {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
    <style> 
        .starability-basic {
            margin-bottom: 1rem;
        }

        /* Reviews Section */
        #reviews {
            margin-top: 2rem;
            padding: 1.5rem 0;
        }

        .review-card {
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid #e0e0e0;
            position: relative;
        }

        .review-card h6 {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #222;
            display: flex;
            align-items: center;
        }

        .review-card h6::before {
            content: "";
            display: inline-block;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: var(--healthcare-blue);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
        }

        .meta {
            font-size: 0.9rem;
            color: #717171;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .stars {
            color: var(--healthcare-blue);
            font-size: 1.1rem;
            margin-bottom: 0.75rem;
            letter-spacing: 1px;
        }

        .review-card p {
            color: #333;
            line-height: 1.6;
            margin-bottom: 1rem;
            font-size: 0.95rem;
        }

        .btn-outline-danger {
            color: var(--healthcare-blue);
            border-color: var(--healthcare-blue);
            font-weight: 500;
            padding: 0.25rem 0.75rem;
            font-size: 0.85rem;
            border-radius: 8px;
            transition: all 0.2s;
        }

        .btn-outline-danger:hover {
            background-color: var(--healthcare-blue);
            color: white;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .review-card {
                padding: 1.25rem;
            }
            
            .review-card h6 {
                font-size: 1rem;
            }
        }
    </style> 
</head>
<body>
    <% if (success && success.length > 0) { %>
    <div class="alert alert-success alert-dismissible fade show mt-3" role="alert">
        <%= success %>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    <% } %>

    <% if (error && error.length > 0) { %>
    <div class="alert alert-danger alert-dismissible fade show mt-3" role="alert">
        <%= error %>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    <% } %>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="#"><i class="fa-solid fa-heart-pulse"></i> MediCare Connect</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <div class="d-flex w-100 align-items-center">
                    <div class="search-bar d-flex align-items-center me-3">
                        <!-- Search functionality can be added here -->
                    </div>
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="/listings">Find Doctors</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#reviews">Patient Reviews</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Specialties</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://jeevan-rakshak-sos-syste-469c6.web.app/">Emergency Care</a>
                        </li>
                    </ul>
                    <!-- User menu can be added here -->
                </div>
            </div>
        </div>
    </nav>

    <!-- Flash Messages -->
    <div class="container position-fixed top-0 start-50 translate-middle-x mt-3" style="z-index: 1050; max-width: 90%;">
        <% if (success && success.length > 0) { %>
        <div class="alert alert-success alert-dismissible fade show shadow" role="alert" style="border-radius: 12px;">
            <i class="fa-solid fa-circle-check me-2"></i> <%= success %>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        <% } %>

        <% if (error && error.length > 0) { %>
        <div class="alert alert-danger alert-dismissible fade show shadow" role="alert" style="border-radius: 12px;">
            <i class="fa-solid fa-triangle-exclamation me-2"></i> <%= error %>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        <% } %>
    </div>

    <!-- Doctor/Service Header -->
    <div class="listing-header">
        <h1 class="listing-title"><%= listing.title %></h1>
        <div class="listing-subtitle">
            <span><i class="fas fa-star"></i> <%= avgRating %> / 5</span>
            <span><i class="fas fa-medal"></i> Board Certified</span>
            <span><%= listing.location %> <%= listing.country %></span>
        </div>
        <div class="guest-favorite">
            <i class="fas fa-award"></i>
            <div>
                <div style="font-weight: 600;">Top Rated Specialist</div>
                <div>This doctor is in the top 10% of medical professionals based on patient reviews and expertise</div>
            </div>
        </div>
        <div class="specialty-tags mt-2">
            
            <span class="specialty-tag">General Medicine</span>
            <span class="specialty-tag">Preventive Care</span>
        </div>
    </div>

    <!-- Image Gallery -->
    <div class="image-gallery">
        <div class="gallery-main">
            <img src="<%= listing.image.url %>" alt="Doctor profile">
        </div>
        <div class="gallery-item">
            <img src="https://images.unsplash.com/photo-1586773860418-d37222d8fce3?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80" alt="Medical facility">
        </div>
        <div class="gallery-item">
            <img src="https://images.unsplash.com/photo-1532938911079-1b06ac7ceec7?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80" alt="Medical equipment">
        </div>
        <div class="gallery-item">
            <img src="https://images.unsplash.com/photo-1559757148-5c350d0d3c56?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80" alt="Doctor consultation">
        </div>
        <div class="gallery-item">
            <img src="https://images.unsplash.com/photo-1599045118108-bf9954418b76?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1074&q=80" alt="Healthcare team">
        </div>
    </div>

    <div class="main-content">
        <div class="left-column">
            <!-- Doctor Details -->
            <div class="listing-info">
                <div class="listing-highlights">
                    <div class="highlight-item">
                        <div class="highlight-icon">
                            <i class="fas fa-user-md"></i>
                        </div>
                        <div>
                            <div style="font-weight: 600;">Experienced Specialist</div>
                            <div>15+ years of medical practice</div>
                        </div>
                    </div>
                    <div class="highlight-item">
                        <div class="highlight-icon">
                            <i class="fas fa-stethoscope"></i>
                        </div>
                        <div>
                            <div style="font-weight: 600;">Comprehensive Care</div>
                            <div>Preventive, diagnostic and treatment services</div>
                        </div>
                    </div>
                    <div class="highlight-item">
                        <div class="highlight-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div>
                            <div style="font-weight: 600;">Flexible Hours</div>
                            <div>Evening and weekend appointments available</div>
                        </div>
                    </div>
                </div>

                <div class="host-info">
                    <div class="host-avatar">DR</div>
                    <div>
                        <h3> <%= listing.title %></h3>
                        <div>Board Certified Â· <%= listing.experience || '5' %> years experience</div>
                    </div>
                </div>
                
                <h2>About the Doctor</h2>
                <div class="description">
                    <p><%= listing.description %></p>
                    <p>Dr. <%= listing.owner.username %> is a board-certified physician specializing in cardiology and internal medicine. With over <%= listing.experience || '15' %> years of experience, they provide comprehensive care focusing on preventive medicine and patient education.</p>
                    
                    <div class="emergency-contact">
                        <h4><i class="fas fa-exclamation-triangle"></i> For Medical Emergencies</h4>
                        <p>If you're experiencing a medical emergency, please call 911 or go to the nearest emergency room immediately. Do not use this platform for urgent medical needs.</p>
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <% if(currUser && currUser._id.equals(listing.owner._id)) {%>
                <div class="action-buttons">
                    <a href=" /listings/<%= listing._id %>/edit" class="btn-edit">
                        <i class="fas fa-edit me-2"></i>Edit this Profile
                    </a>
                    <form method="POST" action="/listings/<%= listing._id %>?_method=DELETE">
                        <button type="submit" class="btn-delete">
                            <i class="fas fa-trash me-2"></i>Remove Listing
                        </button>
                    </form>
                </div>
                <% } %>
            </div>

            <!-- Appointment Booking Section -->
            <section class="container my-5">
                <div class="card shadow-lg p-4 text-center">
                    <h2 class="mb-3">ðŸ“… Book Your Appointment</h2>
                    <p class="text-muted">Schedule a consultation with our doctors easily and quickly.</p>
                    <a href="/bookings/new" class="book-btn mt-3">
                        <i class="fas fa-calendar-check me-2"></i>Book Appointment
                    </a>
                </div>
            </section>

            <!-- Services Offered -->
            <div class="amenities-section">
                <h2>Services Offered</h2>
                <div class="amenities-grid">
                    <div class="amenity-item">
                        <i class="fas fa-heartbeat"></i>
                        <div>Cardiac Consultation</div>
                    </div>
                    <div class="amenity-item">
                        <i class="fas fa-file-medical"></i>
                        <div>Health Screenings</div>
                    </div>
                    <div class="amenity-item">
                        <i class="fas fa-prescription-bottle"></i>
                        <div>Medication Management</div>
                    </div>
                    <div class="amenity-item">
                        <i class="fas fa-laptop-medical"></i>
                        <div>Telehealth Services</div>
                    </div>
                    <div class="amenity-item">
                        <i class="fas fa-procedures"></i>
                        <div>Preventive Care</div>
                    </div>
                    <div class="amenity-item">
                        <i class="fas fa-diagnoses"></i>
                        <div>Diagnostic Tests</div>
                    </div>
                    <div class="amenity-item">
                        <i class="fas fa-clipboard-list"></i>
                        <div>Health Assessments</div>
                    </div>
                    <div class="amenity-item">
                        <i class="fas fa-user-friends"></i>
                        <div>Family Medicine</div>
                    </div>
                </div>
            </div>

            

            <!-- Location Map -->
            <h3>Practice Location</h3>
            <div id="map" style="height: 400px;"></div>

            <!-- Patient Reviews -->
            <section id="reviews" class="mt-5">
                <% for(review of listing.reviews) { %>
                <div class="review-card">
                    <h6><%= review.author.username || "Patient" %></h6>
                    <div class="meta">â˜… <%= review.rating %> stars</div>
                    <div class="stars">
                        <% for(let i = 0; i < review.rating; i++) { %>â˜…<% } %>
                    </div>
                    <p><%= review.comment %></p>
                    <% if(currUser){ %>
                    <form action="/listings/<%= listing._id %>/reviews/<%= review._id %>?_method=DELETE" method="post">
                        <button class="btn btn-sm btn-outline-danger mt-2">Delete</button>
                    </form>
                    <% } %>
                </div>
                <% } %>
            </section>

            <!-- Review Form -->
            <% if (currUser) { %>
            <form method="POST" action="/listings/<%= listing._id %>/reviews" class="review-form needs-validation" novalidate>
                <h3 class="form-title">Share Your Experience</h3>

                <label for="rating">Rating</label>
                <fieldset class="starability-basic">
                    <input type="radio" id="rate1" name="review[rating]" value="1" />
                    <label for="rate1" title="Terrible">1 star</label>

                    <input type="radio" id="rate2" name="review[rating]" value="2" />
                    <label for="rate2" title="Not good">2 stars</label>

                    <input type="radio" id="rate3" name="review[rating]" value="3" />
                    <label for="rate3" title="Average">3 stars</label>

                    <input type="radio" id="rate4" name="review[rating]" value="4" />
                    <label for="rate4" title="Very good">4 stars</label>

                    <input type="radio" id="rate5" name="review[rating]" value="5" checked />
                    <label for="rate5" title="Amazing">5 stars</label>
                </fieldset>

                <label for="comment">Your Experience</label>
                <textarea id="comment" name="review[comment]" class="form-control" placeholder="Share your experience with this doctor..." required></textarea>
                <div class="invalid-feedback">Please share details about your experience</div>

                <button type="submit" class="submit-btn">Submit Review</button>
            </form>
            <% } %>
        </div>

        <!-- Booking Card -->
        <div class="right-column">
            <div class="booking-card">
               
                
                
                
                <select class="guests-select">
                    <option>1 Patient</option>
                    <option>2 Patients</option>
                    <option>Family Consultation (3+)</option>
                </select>
                
                <button class="book-btn"><a href="/bookings/new" class="book-btn">Book Appointment</a></button>
                
                <div class="text-center" style="margin-bottom: 16px; color: var(--medium-gray);">Schedule a consultation with our doctors easily and quickly.

</div>
                
                
                
                
            </div>
            
           
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-column">
                <h4>Patient Resources</h4>
                <ul class="footer-links">
                    <li><a href="#">Find a Doctor</a></li>
                    <li><a href="#">Patient Portal</a></li>
                    <li><a href="#">Medical Records</a></li>
                    <li><a href="#">Insurance Information</a></li>
                    <li><a href="#">Billing & Payments</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>Medical Services</h4>
                <ul class="footer-links">
                    <li><a href="#">Primary Care</a></li>
                    <li><a href="#">Specialty Care</a></li>
                    <li><a href="#">Emergency Services</a></li>
                    <li><a href="#">Preventive Care</a></li>
                    <li><a href="#">Telehealth</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>About Us</h4>
                <ul class="footer-links">
                    <li><a href="#">Our Mission</a></li>
                    <li><a href="#">Leadership</a></li>
                    <li><a href="#">Careers</a></li>
                    <li><a href="#">News & Blog</a></li>
                    <li><a href="#">Contact Us</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>Health Information</h4>
                <ul class="footer-links">
                    <li><a href="#">Health Library</a></li>
                    <li><a href="#">Community Health</a></li>
                    <li><a href="#">Classes & Events</a></li>
                    <li><a href="#">Health Risk Assessments</a></li>
                    <li><a href="#">COVID-19 Resources</a></li>
                </ul>
            </div>
        </div>
        
        <div class="footer-bottom">
            <div>
                <div class="copyright">Â© 2025 MediCare Connect Â· Privacy Â· Terms Â· Accessibility Â· Sitemap</div>
                <div class="footer-lang-currency">
                    <span><i class="fas fa-globe"></i> English (IN)</span>
                    <span><i class="fas fa-rupee-sign"></i> INR</span>
                </div>
            </div>
            <div class="social-links">
                <a href="#"><i class="fab fa-facebook-f"></i></a>
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
                <a href="#"><i class="fab fa-linkedin-in"></i></a>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Form validation
        (() => {
            'use strict';
            const forms = document.querySelectorAll('.needs-validation');
            
            Array.from(forms).forEach(form => {
                form.addEventListener('submit', event => {
                    if (!form.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                });
            });
            
            // Show more functionality for reviews
            document.querySelectorAll('.show-more').forEach(link => {
                link.addEventListener('click', function() {
                    const content = this.previousElementSibling;
                    if (content.style.webkitLineClamp) {
                        content.style.webkitLineClamp = 'unset';
                        this.textContent = 'Show less';
                    } else {
                        content.style.webkitLineClamp = '3';
                        this.textContent = 'Show more';
                    }
                });
            });
        })();
    </script>
    <script>
        const lat = <%= listing.lat || 0 %>;
        const lng = <%= listing.lng || 0 %>;

        const map = L.map('map').setView([lat, lng], 13);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        L.marker([lat, lng]).addTo(map)
            .bindPopup("<%= listing.title %>")
            .openPopup();
    </script>
</body>
</html>